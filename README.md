# Nurtsrx
[![backend-python-django](https://img.shields.io/badge/Backend-Python/Django-green)](https://www.djangoproject.com)
[![frontend-reactjs](https://img.shields.io/badge/Frontend-Javascript/React-blue)](https://reactjs.org)
[![License: Unlicense](https://img.shields.io/badge/License-Unlicense-9cf.svg)](http://unlicense.org/)

An E-commerce and CRUD web application project coded in __Python(Django)__ for creating API([Django Rest Framework](https://www.django-rest-framework.org)) and for the backend  and __Javascript(React)__ on the client side as single page application. Assignment submitted in partial fulfillment of the requirements for the online course in  IT00CD40 Web Technologies, Ã…bo Akademi University. The [project](https://nurtsrx.herokuapp.com) was deployed in __Heroku__ platform.

---

### Directories
- _webshop_: Django config settings folder.
- _src_: React main folder that contains the Javascript entry point, app, page components(pages) reusable components(partials).
- _core_: Django app as an entry point template view to React's __src__ folder.
- _templates_: Django HTML templates files. 
- _public_: React static files directory.
- _tmp/notifications_: Folder where the emails generated by `django.core.mail.backends.filebased EmailBackend` resides.
- _users_: Django user app folder
- _merchandises_: Django item/products app folder
- _cart_: Django cart app when login users added item in the shop page.
- _purchases_: Django app directory that create an object to all paid items in the cart.
- _initial_: Django app for re-population of defaults users and item.
- _build_: React build files.
- _en_: Python virtual environment.

### User Authentication
The app uses  [Django Rest Auth](https://django-rest-auth.readthedocs.io/en/latest/) for authenticating users with API. Login, signup, change password, and logout are handled by this module. Some configuration are set by [Django Allauth](https://django-allauth.readthedocs.io/en/latest/installation.html) in the backend. The default DRF authentication class used was `rest_framework.authentication.TokenAuthentication`.

### Site architecture
- _Landing Page_ https://nurtsrx.herokuapp.com/: Serve as the home page of the application and for   triggering the automatic DB population that generates six users and with three users already have ten items created available for sale. Re-population of users and items owned by users was initiated by using Django's *post_save [signals](https://docs.djangoproject.com/en/3.1/topics/signals/)* in the `users` app.

- _Shop Page_ https://nurtsrx.herokuapp.com/shop: The page to view the available products available for sale that return ten items per page. Paginated using DRF's [rest_framework.pagination.PageNumberPagination](https://www.django-rest-framework.org/api-guide/pagination/#pagenumberpagination) with `page_size = 10` and [react-js-pagination](https://www.npmjs.com/package/react-js-pagination) on the frontend. Authenticated and anonymous users can view all of the items for sales but only the login users can shop and can create _merchandise_ objects as item for sale. Login users can only select and buy `merchandises` that they don't owned/created otherwise it will raise `ValidationError` if that event will happen, but it unlikely to happened because the `add to cart` button was disabled for the current user's item. Items are ordered by `created_date`field as `date added`.

- _Login Page_ https://nurtsrx.herokuapp.com/login: User must provide email and password to be submitted in the form.

- _Signup Page_ https://nurtsrx.herokuapp.com/signup: To register a user, username, email, and password with confirmation must be fullfilled. Username and email are unique model field.

- _Account Page_ https://nurtsrx.herokuapp.com/account: For editing user's password, `request.user`must provide the current password and new password entry with confirmation. */account* is a `protected route`.

- _MyItem Page_ https://nurtsrx.herokuapp.com/myitems: Page where authenticated users can view their own items, sold items and bought item. The add item form and edit item form was also found in this page. Only the user that created the `merchandise object` can modify the required field by patch method. */myitems* is a `protected route`.

- _Logout Page_ https://nurtsrx.herokuapp.com/logout: Logout page. Logout page has `confirmation` and must be confirmed by the authenticated user to be successfully sign out from the system. */logout* is a `protected route`.

- _SingleItem Page_ https://nurtsrx.herokuapp.com/{params.slug}: Pages for every items in the store that redirects when user searches for `merchandise title` as single object.   

- _404 Page_ : Catch all unavailable routes.

### API Endpoints
BASE URI: __https://nurtsrx.herokuapp.com/api/__
Rough draft of API documentation can be found in **https://nurtsrx.herokuapp.com/static/api.html**.
API Documentation generated using [raml2html](https://github.com/raml2html/raml2html).


### Search
Anonymous and login users can search the items by the item's title and by implementing DRF's [search filters](https://www.django-rest-framework.org/api-guide/filtering/#searchfilter) on the backend.

### Security
_Content Security Policy_ and _Permissions Policy_ protection was added to boost the security features of the application. CSP was initiated by installing [django-csp](https://django-csp.readthedocs.io/en/latest/) and set directives such as `default-src`, `script-src`, `style-src`, `connect-src`and etc. with there respective configuration. Permission policy was implemented by [django-feature-policy](https://pypi.org/project/django-feature-policy/). Built-in security settings was carried out mostly on deployment as well as during development stage.

- SECURE_PROXY_SSL_HEADER
- SECURE_SSL_REDIRECT
- SECURE_HSTS_SECONDS
- SECURE_HSTS_INCLUDE_SUBDOMAINS
- SECURE_HSTS_PRELOAD
- SECURE_CONTENT_TYPE_NOSNIFF
- SECURE_REFERRER_POLICY
- SESSION_COOKIE_SECURE
- SESSION_COOKIE_HTTPONLY
- SECURE_BROWSER_XSS_FILTER
- X_FRAME_OPTIONS

To secure the site admin interface, One-Time Password was implemented with [django-otp](https://django-otp-official.readthedocs.io/en/stable/) as well as updating the default admin url path.

### Styling
The website was styled using Bootstrap, Bootswatch(Spacelab theme), Jquery, media queries and custom CSS.


### Python Virtual Environment
```
python -m venv
```

### Project setup
```
pip install
```
React
```
yarn install
```

### Compiles and hot-reloads for development

```
python manage.py runserver
```

```
yarn serve
```

### Compiles and minifies for production
```
yarn build
```

### Lints and fixes files
```
yarn lint
```

### React Boilerplate
[Create React App](https://github.com/facebook/create-react-app).